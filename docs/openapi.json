{"openapi":"3.1.0","info":{"title":"Enterprise Ticket Agent","version":"0.1.0"},"paths":{"/test-llm":{"get":{"summary":"Test Llm","operationId":"test_llm_test_llm_get","responses":{"200":{"description":"Successful Response","content":{"application/json":{"schema":{}}}}}}},"/tickets/":{"post":{"tags":["tickets"],"summary":"Create Ticket","description":"Create a new ticket:\n  - store root ticket + initial messages\n  - call LLM\n  - return structured response + thread","operationId":"create_ticket_tickets__post","requestBody":{"required":true,"content":{"application/json":{"schema":{"$ref":"#/components/schemas/TicketCreateRequest"}}}},"responses":{"200":{"description":"Successful Response","content":{"application/json":{"schema":{"$ref":"#/components/schemas/TicketResponse"}}}},"422":{"description":"Validation Error","content":{"application/json":{"schema":{"$ref":"#/components/schemas/HTTPValidationError"}}}}}},"get":{"tags":["tickets"],"summary":"Get Ticket History","description":"Return the latest tickets to populate the Ticket History list.","operationId":"get_ticket_history_tickets__get","parameters":[{"name":"limit","in":"query","required":false,"schema":{"type":"integer","default":50,"title":"Limit"}}],"responses":{"200":{"description":"Successful Response","content":{"application/json":{"schema":{"type":"array","items":{"$ref":"#/components/schemas/TicketHistoryItem"},"title":"Response Get Ticket History Tickets  Get"}}}},"422":{"description":"Validation Error","content":{"application/json":{"schema":{"$ref":"#/components/schemas/HTTPValidationError"}}}}}}},"/tickets/{ticket_id}/thread":{"get":{"tags":["tickets"],"summary":"Get Thread","description":"Load the full conversation + AI answer for a single ticket.","operationId":"get_thread_tickets__ticket_id__thread_get","parameters":[{"name":"ticket_id","in":"path","required":true,"schema":{"type":"string","title":"Ticket Id"}}],"responses":{"200":{"description":"Successful Response","content":{"application/json":{"schema":{"$ref":"#/components/schemas/TicketThreadResponse"}}}},"422":{"description":"Validation Error","content":{"application/json":{"schema":{"$ref":"#/components/schemas/HTTPValidationError"}}}}}}},"/tickets/{ticket_id}/followup":{"post":{"tags":["tickets"],"summary":"Post Followup","description":"Append a follow-up question / message to an existing ticket,\ncall the LLM again, and return the updated thread.","operationId":"post_followup_tickets__ticket_id__followup_post","parameters":[{"name":"ticket_id","in":"path","required":true,"schema":{"type":"string","title":"Ticket Id"}}],"requestBody":{"required":true,"content":{"application/json":{"schema":{"$ref":"#/components/schemas/FollowupRequest"}}}},"responses":{"200":{"description":"Successful Response","content":{"application/json":{"schema":{"$ref":"#/components/schemas/TicketThreadResponse"}}}},"422":{"description":"Validation Error","content":{"application/json":{"schema":{"$ref":"#/components/schemas/HTTPValidationError"}}}}}}},"/tickets/{ticket_id}/close":{"post":{"tags":["tickets"],"summary":"Close Ticket Route","description":"Mark the ticket as closed. The UI can use this to disable follow-ups.","operationId":"close_ticket_route_tickets__ticket_id__close_post","parameters":[{"name":"ticket_id","in":"path","required":true,"schema":{"type":"string","title":"Ticket Id"}}],"responses":{"200":{"description":"Successful Response","content":{"application/json":{"schema":{}}}},"422":{"description":"Validation Error","content":{"application/json":{"schema":{"$ref":"#/components/schemas/HTTPValidationError"}}}}}}},"/":{"get":{"summary":"Root","operationId":"root__get","responses":{"200":{"description":"Successful Response","content":{"application/json":{"schema":{}}}}}}}},"components":{"schemas":{"FollowupQuestion":{"properties":{"text":{"type":"string","title":"Text"}},"type":"object","required":["text"],"title":"FollowupQuestion"},"FollowupRequest":{"properties":{"message":{"type":"string","title":"Message","description":"User follow-up message text"}},"type":"object","required":["message"],"title":"FollowupRequest"},"HTTPValidationError":{"properties":{"detail":{"items":{"$ref":"#/components/schemas/ValidationError"},"type":"array","title":"Detail"}},"type":"object","title":"HTTPValidationError"},"SimilarIncident":{"properties":{"ticket_id":{"anyOf":[{"type":"string"},{"type":"null"}],"title":"Ticket Id"},"subject":{"anyOf":[{"type":"string"},{"type":"null"}],"title":"Subject"},"description":{"anyOf":[{"type":"string"},{"type":"null"}],"title":"Description"},"similarity_score":{"anyOf":[{"type":"number"},{"type":"null"}],"title":"Similarity Score"}},"type":"object","title":"SimilarIncident"},"SuggestedAction":{"properties":{"title":{"type":"string","title":"Title"},"steps":{"items":{"type":"string"},"type":"array","title":"Steps"}},"type":"object","required":["title","steps"],"title":"SuggestedAction"},"TicketCreateRequest":{"properties":{"subject":{"type":"string","title":"Subject"},"description":{"type":"string","title":"Description"},"user_upn":{"type":"string","title":"User Upn","description":"User's UPN or email"},"severity":{"type":"string","enum":["low","medium","high","critical"],"title":"Severity","default":"medium"}},"type":"object","required":["subject","description","user_upn"],"title":"TicketCreateRequest"},"TicketHistoryItem":{"properties":{"ticket_id":{"type":"string","title":"Ticket Id"},"subject":{"type":"string","title":"Subject"},"severity":{"type":"string","title":"Severity"},"status":{"type":"string","enum":["open","closed"],"title":"Status","default":"open"},"created_at":{"anyOf":[{"type":"string","format":"date-time"},{"type":"string"}],"title":"Created At"}},"type":"object","required":["ticket_id","subject","severity","created_at"],"title":"TicketHistoryItem","description":"Lightweight item for the left-hand 'Ticket History' list."},"TicketMessage":{"properties":{"role":{"type":"string","enum":["user","agent"],"title":"Role"},"content":{"type":"string","title":"Content"},"timestamp":{"anyOf":[{"type":"string","format":"date-time"},{"type":"string"}],"title":"Timestamp"}},"type":"object","required":["role","content","timestamp"],"title":"TicketMessage"},"TicketResponse":{"properties":{"ticket_id":{"type":"string","title":"Ticket Id"},"subject":{"type":"string","title":"Subject"},"description":{"type":"string","title":"Description"},"user_upn":{"type":"string","title":"User Upn"},"severity":{"type":"string","title":"Severity"},"status":{"type":"string","enum":["open","closed"],"title":"Status","default":"open"},"answer":{"type":"string","title":"Answer"},"suggested_actions":{"items":{"$ref":"#/components/schemas/SuggestedAction"},"type":"array","title":"Suggested Actions"},"followup_questions":{"items":{"$ref":"#/components/schemas/FollowupQuestion"},"type":"array","title":"Followup Questions"},"similar_incidents":{"items":{"$ref":"#/components/schemas/SimilarIncident"},"type":"array","title":"Similar Incidents","default":[]},"thread":{"items":{"$ref":"#/components/schemas/TicketMessage"},"type":"array","title":"Thread"}},"type":"object","required":["ticket_id","subject","description","user_upn","severity","answer","suggested_actions","followup_questions","thread"],"title":"TicketResponse","description":"Returned immediately when a new ticket is created.\nContains the first AI answer + structured actions + questions + thread."},"TicketThreadResponse":{"properties":{"ticket_id":{"type":"string","title":"Ticket Id"},"subject":{"type":"string","title":"Subject"},"description":{"type":"string","title":"Description"},"severity":{"type":"string","title":"Severity"},"status":{"type":"string","enum":["open","closed"],"title":"Status","default":"open"},"answer":{"type":"string","title":"Answer"},"suggested_actions":{"items":{"$ref":"#/components/schemas/SuggestedAction"},"type":"array","title":"Suggested Actions"},"followup_questions":{"items":{"$ref":"#/components/schemas/FollowupQuestion"},"type":"array","title":"Followup Questions"},"thread":{"items":{"$ref":"#/components/schemas/TicketMessage"},"type":"array","title":"Thread"},"similar_incidents":{"items":{"$ref":"#/components/schemas/SimilarIncident"},"type":"array","title":"Similar Incidents","default":[]}},"type":"object","required":["ticket_id","subject","description","severity","answer","suggested_actions","followup_questions","thread"],"title":"TicketThreadResponse","description":"Full thread view for a single ticket.\nUsed when loading /tickets/{id}/thread and when posting follow-ups."},"ValidationError":{"properties":{"loc":{"items":{"anyOf":[{"type":"string"},{"type":"integer"}]},"type":"array","title":"Location"},"msg":{"type":"string","title":"Message"},"type":{"type":"string","title":"Error Type"}},"type":"object","required":["loc","msg","type"],"title":"ValidationError"}}}}